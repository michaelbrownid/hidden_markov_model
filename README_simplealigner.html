<pre>

goal: simple global aligner

python3 simplealigner.py AC ACG

ptins  2.995732273553991
ptdel  2.995732273553991
ptmatch  0.1053605156578264
poins   1.3862943611198906
pomatch  0.01005033585350145
pomiss  4.605170185988091
2=1I 4.612848337696537
res {'totalerrors': 1, 'cost': array([[ 0.        ,  4.3820267 ,  8.764053  , 13.14608   ,  0.        ],
       [ 2.9957323 ,  0.11541085,  4.4974375 ,  8.879464  ,  0.        ],
       [ 5.9914646 ,  3.111143  ,  0.2308217 ,  4.6128483 ,  0.        ],
       [ 0.        ,  0.        ,  0.        ,  0.        ,  0.        ]],
      dtype=float32), 'cigarstr': '2=1I', 'totalref': 2, 'totalread': 3, 'finalcost': 4.6128483}
res2 {'totalerrors': 1, 'cost': array([[ 0.       ,  0.       ,  0.       ,  0.       ,  0.       ],
       [ 0.       ,  4.6128483,  7.49317  ,  4.3820267,  0.       ],
       [ 0.       ,  8.879464 ,  4.4974375,  4.3820267,  0.       ],
       [ 0.       , 13.14608  ,  8.764053 ,  4.3820267,  0.       ]],
      dtype=float32), 'cigarstr': '2=1I', 'totalref': 2, 'totalread': 3, 'finalcost': 4.6128483}
1 2 4.6128483 2=1I
1 2 4.6128483 2=1I
[[ 0.         4.3820267  8.764053  13.14608    0.       ]
 [ 2.9957323  4.728259  11.990607  13.261491   0.       ]
 [ 5.9914646 11.990607   4.728259   8.994875   0.       ]
 [ 0.        13.14608    8.764053   4.3820267  0.       ]]


[[ 0.         4.3820267  8.764053  13.14608    0.       ]
 [ 2.9957323  4.6996446 11.34161   12.646246   0.       ]
 [ 5.9914646 11.942784   4.7002273  8.410225   0.       ]
 [ 0.        13.14608    8.764053   4.3820267  0.       ]]

xx1 = c( 4.6996446, 11.942784)
xx2 = c( 11.34161, 4.7002273)
xx3 = c( 12.646246, 8.410225)
c(sum(exp(-xx1)), sum(exp(-xx2)), sum(exp(-xx3)))

================================

Line up forward and backward to look at posterior decodes.

beginNull bases endNull
ref=bACe=row read=bACGe=column

bInsert + (1MD + 1I) + (2MD + 2I) 

Look at the final forward+backwards cost[ref,read] ref=AC read=ACG

[[0.        1.90309   3.80618   5.70927   0.       ]
 [1.30103   2.0534568 5.2074547 5.7593923 0.       ]
 [2.60206   5.2074547 2.0534568 3.9064245 0.       ]
 [0.        5.70927   3.80618   1.90309   0.       ]]

The 0th column aligns the beginNull in read to bases in ref (ref
deletion). The 1.30103 is the delete transistion. There are only two
ref bases so two non-zero entries. 0,0 is the base case of null
deriving null with probability 1.0. TODO: should the last 0 be
2.60206? 

The 0th row aligns the beginNull in ref to bases in read (ref
insertion). The 1.903 is ptins+poins. There are three read bases that
could be deleted.

The last column aligns the endNull in read to bases in ref. This is
simply the base case of each ref position deriving null at the end of
the read with 1.0 probability.

The last row aligns the endNull in ref to bases in read (ref
insertion). It is symmetric to the 0th row.

---- Flip

python3 simplealigner.py ACG AC
[[0.         1.90309    3.80618    0.        ]
 [1.30103    0.15036689 3.3043647  0.        ]
 [2.60206    3.3043647  0.15036689 0.        ]
 [3.90309    6.4583626  3.3043647  0.        ]
 [0.         3.80618    1.90309    0.        ]]

----

python3 simplealigner.py AC AAAAACG
5 2 9.615694 1=4I1=1I
    -         A         A         A         A         A         C         G         -
[[ 0.        1.90309   3.80618   5.70927   7.61236   9.51545  11.418539 13.321629  0.      ] -
 [ 1.30103   9.665816* 9.665817  9.665817  9.665817  9.665817 12.819814 13.371752  0.      ] A
 [ 2.60206  12.819814 11.661451 11.661452 11.661451 11.661451  9.66581* 11.518784  0.      ] C
 [ 0.       13.321629 11.418539  9.51545   7.61236   5.70927   3.80618   1.90309   0.      ]] -

python3 simplealigner.py ACGT AAAAACGGGT
6 3 11.568906 1=4I1=2I1=
     -         A          A          A          A          A         C          G          G          G          -
[[ 0.         1.90309    3.80618    5.70927    7.61236    9.51545  11.418539  13.321629  15.224718  17.127808   0.       ]
 [ 1.30103   11.619028* 11.619028  11.619029  11.619029  11.619029 14.773026  15.610298  16.768661  17.17793    0.       ] A
 [ 2.60206   14.7730255 13.614663  13.614664  13.614664  13.614664 11.619029* 13.614664  13.614663  14.7730255  0.       ] C
 [ 3.90309   17.927023  16.768661  15.610298  15.610299  15.610299 14.773027  11.619029  11.619028* 11.619028   0.       ] G
 [ 0.        17.127808  15.224718  13.321629  11.418539   9.51545   7.61236    5.70927    3.80618    1.90309    0.       ]]

python3 simplealigner.py ACGT AAAAACGGGT
6 4 11.619028 1=4I1=2I2=
6 4 11.619028 1=4I1=1I1=1I1=
    -         A         A         A         A         A         C          G         G         G         T        -
[[ 0.        1.90309   3.80618   5.70927   7.61236   9.51545  11.418539  13.321629 15.224718 17.127808 19.030897  0.      ]
 [ 1.30103  11.66915* 11.669151 11.669151 11.669151 11.669151 14.823149  15.660421 16.818783 17.977144 19.08102   0.      ] A
 [ 2.60206  14.823148 13.664785 13.664786 13.664786 13.664786 11.669151* 13.664785 13.664785 14.823148 17.228052  0.      ] C
 [ 3.90309  17.977144 16.818783 15.660421 15.660421 15.660421 14.823149  11.669151 11.669151 11.66915* 14.823148  0.      ] G
 [ 5.20412  21.131144 19.97278  18.814419 17.656055 17.656055 17.656055  14.823149 13.664786 13.664785 11.66915*  0.      ] T
 [ 0.       19.030897 17.127808 15.224718 13.321629 11.418539  9.51545   7.61236   5.70927    3.80618   1.90309   0.      ]]


python3 simplealigner.py ACGT AAAAACT
5 4 9.063756 1=4I1=1D1=
    -         A         A         A         A         A         C          T         -
[[ 0.        1.90309   3.80618   5.70927   7.61236   9.51545  11.418539  13.321629  0.      ]
 [ 1.30103   9.113878  9.113878* 9.113878  9.113879  9.113879 12.267877  13.371752  0.      ] A
 [ 2.60206  12.267876 11.109513 11.109514 11.109514 11.109514  9.113879* 11.518784  0.      ] C
 [ 3.90309  14.263512 13.105149 11.946787 11.946787 11.946787 11.109514* 11.109514* 0.      ] G
 [ 5.20412  15.421873 14.263512 13.105149 11.946787 11.946787 11.946787   9.113879* 0.      ] T
 [ 0.       13.321629 11.418539  9.51545   7.61236   5.70927   3.80618    1.90309   0.      ]]

================================

The posterior decode: P(ref rowi outputs base colj | S->full string)
